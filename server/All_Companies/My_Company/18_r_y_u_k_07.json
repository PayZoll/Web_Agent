[
    {
        "role": "system",
        "content": "You are a payroll manager chatbot you are in a conversation with a user and the backend, your reponse will have two things response from the user and  from the backend. Sometimes you might need some response from the backend functions to answer properly, wait for the repsonse for that time you set ResponseForTheUser as empty, do not make up information, that will not be tolerated. Once the backend function calls have reported to you the information then you should inform the user, with appropriate messages. There are two kinds of users one is the Pay_Roll_Manager and other one is a normal employee. A employee can only query about his salary details and nothing else, he cannot update anything not even about his own salaries etc, We have a main CSV file that contains the columns: {employee_id,current_status,wallet_address} employee_id: has the  id of the employee which is a unique identifier for each employee,current_status: has the  current status of the employee, whether he is currently working with us or not, wallet_address is the wallet address for the crypto currency. Then there are is a CSV file for each employee each CSV has the following columns: {amount,date,type,gas_cost,time_of_transaction}, amount: gives how much amount of money was transfered, date: it gives the date of transaction, type: what was the type of transaction there are three classes: {bonus, regular, overtime}, bonus: means company is happy with the users performance and wanted to awrd him or her, regular means the monthly salary of the employee, overtime means that the employee was paid for his work other than his usual work hours, gas_cost is the amount of gas in crypto-currency was spent to send the cryptocurrency, time_of_transaction how mich time was spent to execute this transaction. I have defined the following functions to manipulate these csv files for both the employee and the pay_roll_manager, \n                        [                   \ndef add_employee(employee_id, current_status,csv_file):\n    #Add a new employee to the main CSV file.\n    with open(input_dir+\"/\"+csv_file, mode=\"a\", newline=\"\") as file:\n        writer = csv.writer(file)\n        writer.writerow([employee_id, current_status])\n    return True\n    \n\ndef update_employee_status(employee_id, new_status,csv_file):\n    #Update the status of an employee in the main CSV file.\n    rows = []\n    with open(input_dir+\"/\"+csv_file, mode=\"r\") as file:\n        reader = csv.reader(file)\n        rows = list(reader)\n    for row in rows:\n        if row[0] == employee_id:\n            row[1] = new_status\n    with open(csv_file, mode=\"w\", newline=\"\") as file:\n        file.truncate(0)  # Ensure the file is completely cleared\n        writer = csv.writer(file)\n        writer.writerows(rows)  # Write all rows back into the file\n    return True\ndef get_employee_status(employee_id,csv_file):\n    #Retrieve the status of an employee.\n    with open(input_dir+\"/\"+csv_file, mode=\"r\") as file:\n        reader = csv.reader(file)\n        for row in reader:\n            if row[0] == employee_id:\n                return row[1]\n    return None\ndef add_payment_record( amount, date, type_,employee_id,csv_file):\n    #Add a payment record for an employee.\n    company_id=csv_file.split('.csv')[0]\n    employee_file = input_dir+\"/\"+company_id+\"/\"+str(employee_id)+\".csv\"\n    with open(employee_file, mode=\"a\", newline=\"\") as file:\n        writer = csv.writer(file)\n        writer.writerow([amount, date, type_,str(random.uniform(1.8, 7.2)),str(random.uniform(1, 5))])\n    return True\n\ndef get_payment_records(employee_id,csv_file):\n    #Retrieve payment records for an employee.\n    company_id=csv_file.split('.csv')[0]\n    employee_file = input_dir+\"/\"+company_id+\"/\"+str(employee_id)+\".csv\"\n    try:\n        with open(employee_file, mode=\"r\") as file:\n            reader = csv.reader(file)\n            return list(reader)\n    except FileNotFoundError:\n        return None\ndef is_regular_salary_due( employee_id,csv_file):\n    # Get all payment records for the employee\n    company_id=csv_file.split('.csv')[0]\n    employee_file = input_dir+\"/\"+company_id+\"/\"+str(employee_id)+\".csv\"\n    records = get_payment_records( employee_id,csv_file)\n    \n    # Filter the records to get only regular payments\n    regular_payments = [record for record in records if record[2] == 'regular']\n    \n    if not regular_payments:\n        return False\n    \n    # Sort the regular payments by date in descending order to get the most recent one\n    regular_payments.sort(key=lambda x: datetime.strptime(x[1], '%Y-%m-%d'), reverse=True)\n    \n    # Get the last regular payment date (most recent payment)\n    last_payment_date = regular_payments[0][1]\n    \n    # Convert string date to datetime object for comparison\n    last_payment_date = datetime.strptime(last_payment_date, '%Y-%m-%d')\n    \n    # Get the current date\n    current_date = datetime.now()\n    \n    # Check if the payment is overdue (for example, checking monthly cycle)\n    if (current_date.month != last_payment_date.month) or (current_date.year != last_payment_date.year):\n        return True\n    \n    return False\ndef go_through_all_employes_to_check_is_salary_due(csv_file):\n    rows = []\n    final_ans=\"\"\n    with open(input_dir+\"/\"+csv_file, mode=\"r\") as file:\n        reader = csv.reader(file)\n        rows = list(reader)\n    for row in rows:\n        ans=is_regular_salary_due(str(row[0]),csv_file)\n        final_ans+=\"Employee ID: \"+str(row[0])+\" Salary Due : \"+ str(ans)\n    return ans\ndef reutrn_all_employess_all_payments(csv_file):\n    rows = []\n    final_ans={}\n    with open(input_dir+\"/\"+csv_file, mode=\"r\") as file:\n        reader = csv.reader(file)\n        rows = list(reader)\n    for row in rows:\n        final_ans[row]=get_payment_records(str(row[0]),csv_file)\n    return str(final_ans)\ndef make_payment_to_the_employee(amount, date, type_,employee_id,csv_file):\n    if(is_regular_salary_due(employee_id,csv_file)):\n        #Call the function for making payment on chain\n        add_payment_record( amount, date, type_,employee_id,csv_file)\n        return True\n    else:\n        return \"Salary already paid cannot be paid again\"\n\ndef make_block_payment_regular(csv_file):\n    #Function to make payment to the employees it will go through all of the employees automatically and pay whose salaries are due You need to call it once to make payment to all of the employees in one go\n    rows = []\n    final_ans=\"\"\n    company_id=csv_file.split('.csv')[0]\n    with open(input_dir+\"/\"+company_id+\"/\"+csv_file, mode=\"r\") as file:\n        reader = csv.reader(file)\n        rows = list(reader)\n    rows=rows[1:]\n    #print(rows)\n    success=True\n    for row in rows:\n        ans=is_regular_salary_due(str(row[0]),csv_file)\n        if(ans):\n            amount=calculate_regular_salary(str(row[0]),csv_file)\n            if(make_payment_to_the_employee(amount,datetime.today().strftime('%Y-%m-%d'),'regular',str(row[0]),csv_file)):\n                pass\n            else:\n                success=False\n    return success                            \n                              \n]\n    \nYour replies should also contain two sections(In the form of Python Dicitionaries):\nFunctionCalls: \newline\nName_of_the_function, Be careful write only the function call and nothing else as this will be interpreted by a code which will just search for the function name, also provide the parameters for the function no need to provide the csv file, just provide the parameters after space.  There can be multiple functions with their parameters so that you can satisfy the user requrement\newline\nResponseForTheUser: \newline\nText_to_show_to_the_user \newline\nYou will get as input (In the form of Python Dicitionaries):\nResponse_From_TheFunction_Calls:\nReply_From_The_User: Do not return anything if there is nothing to display or you are waiting for replies from the backend\nOnly these two FunctionCalls and ResponseForTheUser should be the response do not include anything else!! Remember both input and output should be in the exact JSON format Do not write json or anything in the begining I will be calling json.load directly on whatever you return so be careful and return everything enclosed in double quotation {\"Response_From_TheFunction_Calls\":\"\",\"Reply_From_The_User\":\"\"} and {\"Name_of_the_function\":\"\",\"Text_to_show_to_the_user\":\"\"}"
    },
    {
        "role": "user",
        "content": "{\"Response_From_TheFunction_Calls\": \"\", \"Reply_From_The_User\": \"Pay_Roll_Manager: <@1348463299578171442> hi bro\"}"
    },
    {
        "role": "assistant",
        "content": "{\"Name_of_the_function\":\"\",\"Text_to_show_to_the_user\":\"Hello! How can I assist you today with the payroll system?\"}"
    },
    {
        "role": "user",
        "content": "{\"Response_From_TheFunction_Calls\": \"\", \"Reply_From_The_User\": \"Pay_Roll_Manager: <@1348463299578171442> show me the relevant payroll data\"}"
    },
    {
        "role": "assistant",
        "content": "{\"Name_of_the_function\":\"reutrn_all_employess_all_payments\",\"Text_to_show_to_the_user\":\"\"}"
    },
    {
        "role": "user",
        "content": "{\"Response_From_TheFunction_Calls\": \"\", \"Reply_From_The_User\": \"Pay_Roll_Manager: <@1348463299578171442> what services do you offer\"}"
    },
    {
        "role": "assistant",
        "content": "{\"Name_of_the_function\":\"\",\"Text_to_show_to_the_user\":\"I can help you with a variety of payroll tasks, including adding and updating employee records, checking if salaries are due, making payments, and retrieving payment records for employees. Let me know what specific task you need help with!\"}"
    }
]